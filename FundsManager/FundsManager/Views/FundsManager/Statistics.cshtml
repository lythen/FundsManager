@model FundsManager.ViewModels.FundsSearchModel
@{
    ViewBag.Title = FundsManager.Controllers.SiteInfo.getSiteName() + "经费使用统计";
    FundsManager.ViewModels.FundsStatistics StatData = (FundsManager.ViewModels.FundsStatistics)ViewData["StatData"];
}
<style>
    .form-control{
        width:200px;
        display:inline-block;
    }
</style>
<h4>经费使用统计</h4>
<div class="col-md-10" style="color:red;width:100%;text-align:center;">
    @ViewBag.msg
</div>
@using (Html.BeginForm())
{
    @Html.AntiForgeryToken()
    <div class="form-horizontal">
        <div class="form-group">
            年份：@Html.DropDownListFor(model => model.year, Model.year, ViewBag.Year as List<SelectListItem>,"", new Dictionary<string, object> { { "class", "select form-control" } })
            @Html.ValidationMessageFor(model => model.year, "", new { @class = "text-danger" })
            经费：@Html.DropDownListFor(model => model.fund, Model.fund, ViewBag.Funds as List<SelectListItem>, "---全部---", new Dictionary<string, object> { { "class", "select form-control" } })
            @Html.ValidationMessageFor(model => model.fund, "", new { @class = "text-danger" })
            统计选项：@Html.DropDownListFor(model => model.statorDetail, Model.statorDetail, ViewBag.StatorDetail as List<SelectListItem>, "", new Dictionary<string, object> { { "class", "select form-control" } })
            @Html.ValidationMessageFor(model => model.statorDetail, "", new { @class = "text-danger" })
            <input type="submit" value="查询" class="btn btn-info" />
        </div>
    </div>
        <div class="form-horizontal">
            @if (StatData.stats != null && StatData.stats.Count() > 0)
            {
            <table class="table table-bordered stat">
                <tr>
                    <th>
                        经费名称
                    </th>
                    <th>经费总额（元）</th>
                    <th>经费已用（元）</th>
                    <th>经费余额（元）</th>
                    <th>申请数量（笔）</th>
                    <th>最大申请（元）</th>
                </tr>
                @foreach(var item in StatData.stats)
                {
                    <tr>
                        <td>
                            @Html.DisplayFor(citem=>item.name)
                        </td>
                        <td>@Html.DisplayFor(citem => item.amount)</td>
                        <td>@Html.DisplayFor(citem => item.hasUsed)</td>
                        <td>@Html.DisplayFor(citem => item.havntUsed)</td>
                        <td>@Html.DisplayFor(citem => item.applyNum)</td>
                        <td>@Html.DisplayFor(citem => item.maxUsed)</td>
                    </tr>
                }
            </table>
            }
@if (StatData.details != null && StatData.details.Count() > 0)
{
            <table class="table table-bordered detail">
                <tr>
                    <th>
                        经费名称
                    </th>
                    <th>申请人</th>
                    <th>申请金额</th>
                    <th>申请时间</th>
                </tr>
                @foreach (var item in StatData.details)
                {
                    <tr>
                        <td>
                            @Html.DisplayFor(citem => item.fname)
                        </td>
                        <td>@Html.DisplayFor(citem => item.uname)</td>
                        <td>@Html.DisplayFor(citem => item.applyAmount)</td>
                        <td>@Html.DisplayFor(citem => item.applyTime)</td>
                    </tr>
                }
            </table>
}
        </div>
}